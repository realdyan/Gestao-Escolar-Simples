export struct MatriculaRow {
    id: int,
    aluno_nome: string,
    turma_nome: string,
    data: string,
    status: string,
}

export component MatriculasScreen inherits Rectangle {
    in-out property <string> modo: "listar";
    in-out property <[MatriculaRow]> dados: [];
    
    in-out property <string> form_id_aluno: "";
    in-out property <string> form_id_turma: "";
    in-out property <string> form_data: "";
    
    callback salvar();
    callback deletar(int);
    
    background: #f5f5f5;
    
    VerticalLayout {
        padding: 20px;
        spacing: 15px;
        
        HorizontalLayout {
            spacing: 10px;
            Text { text: "üéì Gest√£o de Matr√≠culas"; font-size: 22px; font-weight: 700; color: #2c3e50; }
            Rectangle { }
            if modo == "listar" : Rectangle {
                width: 150px; height: 35px;
                background: #2ecc71;
                border-radius: 5px;
                TouchArea { clicked => { modo = "cadastrar"; } }
                Text { text: "üÜï Nova Matr√≠cula"; color: white; vertical-alignment: center; horizontal-alignment: center; }
            }
        }

        // CORRE√á√ÉO: Usando Flickable + VerticalLayout em vez de ListView
        if modo == "listar" : Flickable {
            VerticalLayout {
                spacing: 8px;
                for row in dados : Rectangle {
                    height: 50px;
                    background: white;
                    border-radius: 5px;
                    border-width: 1px;
                    border-color: #ecf0f1;
                    
                    HorizontalLayout {
                        padding: 10px;
                        Text { text: row.aluno_nome; width: 30%; vertical-alignment: center; color: #2c3e50; }
                        Text { text: row.turma_nome; width: 30%; vertical-alignment: center; color: #2c3e50; }
                        Text { text: row.data; width: 20%; vertical-alignment: center; color: #7f8c8d; }
                        
                        Rectangle {
                            width: 80px;
                            background: #e74c3c;
                            border-radius: 3px;
                            TouchArea { clicked => { deletar(row.id); } }
                            Text { text: "Remover"; color: white; horizontal-alignment: center; vertical-alignment: center; }
                        }
                    }
                }
            }
        }

        if modo == "cadastrar" : VerticalLayout {
            // (O seu c√≥digo de formul√°rio est√° correto, mantenha-o aqui)
            spacing: 15px;
            Rectangle {
                background: white;
                border-radius: 8px;
                VerticalLayout {
                    spacing: 10px;
                    Text { text: "ID do Aluno:"; color: #2c3e50; font-weight: 600; }
                    Rectangle { height: 35px; background: #f9f9f9; TextInput { text <=> form_id_aluno; color: black; } }
                    Text { text: "ID da Turma:"; color: #2c3e50; font-weight: 600; }
                    Rectangle { height: 35px; background: #f9f9f9; TextInput { text <=> form_id_turma; color: black; } }
                    Text { text: "Data (AAAA-MM-DD):"; color: #2c3e50; font-weight: 600; }
                    Rectangle { height: 35px; background: #f9f9f9; TextInput { text <=> form_data; color: black; } }
                    HorizontalLayout {
                        spacing: 10px;
                        padding-top: 20px;
                        Rectangle {
                            height: 40px; background: #2ecc71; border-radius: 5px;
                            TouchArea { clicked => { salvar(); } }
                            Text { text: "Confirmar Matr√≠cula"; color: white; horizontal-alignment: center; vertical-alignment: center; }
                        }
                        Rectangle {
                            height: 40px; background: #bdc3c7; border-radius: 5px;
                            TouchArea { clicked => { modo = "listar"; } }
                            Text { text: "Cancelar"; color: #2c3e50; horizontal-alignment: center; vertical-alignment: center; }
                        }
                    }
                }
            }
        }
    }
}